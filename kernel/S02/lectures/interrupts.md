# Interrupts

Events that interrupt the current flow of execution.  
They can be created by hardware or the CPU itself.  
An interrupt handler runs and after it finishes, execution continues.

types:
- synchronous, generated by executing an instruction -> Exceptions
- asynchronous, generated by an external event -> Interrupts.
- maskable, can be ignored signaled via INT pin
- non-maskable cannot be ignored signaled via NMI pin

Exceptions:
* processor detected
    - faults
    - traps
    - aborts
* programmed
    - int n

QUIZ:

breakpoint -> trap
system call -> interrupt
timer -> maskable
division by 0 -> exception
demand paging -> fault
watchdog -> non-maskable

QUIZ:  
**True**  - The CPU can start processing a new interrupt before the current one is finished  
**True**  - Interrupts can be disabled at the device level  
**False**  - Lower priority interrupts can not preempt handlers for higher priority interrupts  
**True**  - Interrupts can be disabled at the interrupt controller level  
**True**  - On SMP systems the same interrupt can be routed to different CPUs  
**True**  - Interrupts can be disabled at the CPU level

QUIZ:

    monitor info registers
    set $idtr = 0xff800000
    set $idtr_entry = *(uint64_t*)($idtr + 8 * 128)
    set $idtr_addr=($idtr_entry>>48<<16)|($idtr_entry&0xffff)
    print (void*)$idtr_addr
    (void *) 0xc15de874 <entry_INT80_32>
    // End
    This doesnt fit. (void *) 0xc15de780 <entry_SYSENTER_32>

### Interrupt context
- it runs as a result of an IRQ (not of an exception)
- there is no well defined process context associated
- not allowed to trigger a context switch (no sleep, schedule, or user memory access)

QUIZ:  
Which of the following phases of interrupt handling runs with interrupts disabled at the CPU level?  

- Critical
- Immediate
- Deferred

